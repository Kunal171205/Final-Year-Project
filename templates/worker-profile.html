<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>My Profile | Industrial Explorer</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/worker-profile.css') }}">
</head>

<body>

<!-- HEADER -->
<header class="top-header">
  <div class="logo">Industrial Explorer</div>
  <nav>
    {% if session.get('user_type') == 'worker' %}
      <a href="{{ url_for('home') }}">Home</a>
      <a href="{{ url_for('jobportal') }}">Job Portal</a>
      <a href="{{ url_for('workerprofile') }}">Profile</a>
      <a href="{{ url_for('logout') }}">Logout</a>
    {% elif session.get('user_type') == 'company' %}
      <a href="{{ url_for('home') }}">Home</a>
      <a href="{{ url_for('b2bhome') }}">B2B Trade</a>
      <a href="{{ url_for('companyprofile') }}">Profile</a>
      <a href="{{ url_for('logout') }}">Logout</a>
    {% else %}
      <a href="{{ url_for('home') }}">Home</a>
      <a href="{{ url_for('jobportal') }}">Job Portal</a>
      <a href="{{ url_for('b2bhome') }}">B2B Trade</a>
      <a href="{{ url_for('logintype') }}">Login</a>
    {% endif %}
  </nav>
</header>

<!-- PAGE -->
<div class="page-container">

  <!-- PROFILE CARD -->
  <div class="profile-card">
    <div class="profile-header">
      <div class="avatar">ðŸ‘·</div>
      <div>
        <h2>{{ worker.username }}</h2>
        <p>Worker Profile</p>
      </div>
    </div>

    <div class="profile-info">
      <div><strong>Username:</strong> {{ worker.username }}</div>
      <div><strong>Total Applications:</strong> {{ applications|length }}</div>
    </div>
  </div>

  <!-- APPLIED JOBS -->
  <!-- APPLIED JOBS -->
<div class="jobs-card">
  <h3>Applied Jobs</h3>

  {% if applications %}
    {% for item in applications %}
    <div class="job-row">

      <div class="job-details">
        <h4>{{ item.job.job_title }}</h4>
        <p>{{ item.job.job_category }} â€“ {{ item.job.job_location }}</p>

        <p class="applied-date">
          Applied: {{ item.application_date.strftime('%Y-%m-%d') }}
        </p>
      </div>

      <div class="job-actions">
        <span class="status {{ item.applicant_status }}">
          {{ item.applicant_status|title }}
        </span>

        {% if item.applicant_status == 'pending' %}
        <form method="POST"
              action="{{ url_for('cancel_application', app_id=item.application_id) }}">
          <button type="submit"
                  class="cancel-btn"
                  onclick="return confirm('Cancel this application?')">
            Cancel
          </button>
        </form>
        {% endif %}
      </div>

    </div>
    {% endfor %}
  {% else %}
    <p>You haven't applied for any jobs yet.</p>
    <a href="{{ url_for('jobportal') }}">Browse Jobs</a>
  {% endif %}
</div>

</div>

</body>
</html>
